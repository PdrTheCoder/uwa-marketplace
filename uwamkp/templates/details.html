{% extends "base.html" %}
{% block title %}Product details{% endblock %}
{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/style-products.css') }}">

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <!-- image -->
            <img src="{{ url_for('static', filename='#..') }}" alt="Product Image" class="img-fluid">
        </div>
        <div class="col-md-6">
            <!-- goods details -->
            <h2>{{ listing.title }}</h2>
            <h2 class="basicinfo">Price:</h2>
            <p>${{ listing.price }}</p>
            <h2 class="basicinfo">Condition:</h2>
            <p>{{ listing.condition }}</p>
            <h2 class="basicinfo">Description:</h2>
            <p>{{ listing.description }}</p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-4">
            <!-- Seller information -->
            <h4>Seller Information</h4>
            <p><strong>Username:</strong> {{ listing.seller_name }}</p>
            <p><strong>User ID:</strong> {{ listing.seller_id }}</p>
            <!-- seller avatar haven't added -->
            <!-- <img src="{{ url_for('static', filename='#sellerimage') }}" alt="Seller Photo" class="seller-img"> -->
        </div>
        <div class="col-md-8">
            <!-- message board to seller -->
            <h4>Post a Message</h4>
            <form id="messageForm" name="postMessage">
                <textarea class="form-control mt-2" id="messageInput" placeholder="Enter your message here..."></textarea>
                <button class="btn btn-success mt-2" onclick="postMessage()">Post Message</button>
            </form>
        </div>
    </div>
    <div class="row">
        <!-- message board -->
        <div class="col-md-12">
            <h4>Message Board</h4>
            <div class="message-board">
                <!-- Messages will be displayed here -->
            </div>
        </div>
    </div>
</div>

<script>
    function postMessage(){
        var message = document.getElementById('messageInput').value;
        var messageBoard = document.querySelector('.message-board');

        if (message.trim() === '') {
            alert('Please enter your message.'); 
            return;
        }

        var now = new Date();
        var formattedDate = now.getFullYear() + '-' + 
                            (now.getMonth()+1).toString().padStart(2,'0') + '-' + 
                            now.getDate().toString().padStart(2,'0') + ' ' + 
                            now.getHours().toString().padStart(2,'0') + ':' + 
                            now.getMinutes().toString().padStart(2,'0')         
        var newMessage = <div class="card mt-2">
                            <div class="card-body">
                                <p>${message}</p>
                                <small>Posted by You on ${formattedDate}</small>
                            </div>
                        </div>;

        messageBoard.innerHTML += newMessage;
        document.getElementById('messageInput').value = ''; 
        }
</script>

{% endblock %}
